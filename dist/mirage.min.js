var mirage;!function(t){t.version="0.1.0"}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(t){t.invalidateMeasure(),t.invalidateArrange();var e=t.tree.parent;e&&e.invalidateMeasure()}var i=function(){function i(){this.init()}return i.prototype.init=function(){Object.defineProperties(this,{inputs:{value:this.createInputs(),writable:!1},state:{value:this.createState(),writable:!1},tree:{value:this.createTree(),writable:!1},attached:{value:{},writable:!1}}),this.$measurer=this.createMeasurer(),this.$arranger=this.createArranger()},i.prototype.createInputs=function(){return{visible:!0,useLayoutRounding:!0,margin:new t.Thickness,width:NaN,height:NaN,minWidth:0,minHeight:0,maxWidth:Number.POSITIVE_INFINITY,maxHeight:Number.POSITIVE_INFINITY,horizontalAlignment:t.HorizontalAlignment.stretch,verticalAlignment:t.VerticalAlignment.stretch,attached:{}}},i.prototype.createState=function(){return{flags:e.LayoutFlags.none,lastAvailable:new t.Size(NaN,NaN),desiredSize:new t.Size,hiddenDesire:new t.Size,layoutSlot:new t.Rect(NaN,NaN,NaN,NaN),arrangedSlot:new t.Rect,lastArrangedSlot:new t.Rect(NaN,NaN,NaN,NaN)}},i.prototype.createTree=function(){return e.DefaultLayoutTree()},i.prototype.createMeasurer=function(){var t=this;return e.NewMeasurer(this.inputs,this.state,this.tree,function(e){return t.measureOverride(e)})},i.prototype.createArranger=function(){var t=this;return e.NewArranger(this.inputs,this.state,this.tree,function(e){return t.arrangeOverride(e)})},Object.defineProperty(i.prototype,"visible",{get:function(){return this.inputs.visible},set:function(t){if(this.inputs.visible!==t){this.inputs.visible=t===!0,this.invalidateMeasure();var e=this.tree.parent;e&&e.invalidateMeasure()}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"useLayoutRounding",{get:function(){return this.inputs.useLayoutRounding},set:function(t){this.inputs.useLayoutRounding!==t&&(this.inputs.useLayoutRounding=t===!0,this.invalidateMeasure(),this.invalidateArrange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"margin",{get:function(){return this.inputs.margin},set:function(e){t.Thickness.isEqual(this.inputs.margin,e)||(this.inputs.margin=e,r(this))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.inputs.width},set:function(t){this.inputs.width!==t&&(this.inputs.width=t,r(this))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.inputs.height},set:function(t){this.inputs.height!==t&&(this.inputs.height=t,r(this))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minWidth",{get:function(){return this.inputs.minWidth},set:function(t){this.inputs.minWidth!==t&&(this.inputs.minWidth=t,r(this))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minHeight",{get:function(){return this.inputs.minHeight},set:function(t){this.inputs.minHeight!==t&&(this.inputs.minHeight=t,r(this))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxWidth",{get:function(){return this.inputs.maxWidth},set:function(t){this.inputs.maxWidth!==t&&(this.inputs.maxWidth=t,r(this))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxHeight",{get:function(){return this.inputs.maxHeight},set:function(t){this.inputs.maxHeight!==t&&(this.inputs.maxHeight=t,r(this))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"horizontalAlignment",{get:function(){return this.inputs.horizontalAlignment},set:function(t){this.inputs.horizontalAlignment!==t&&(this.inputs.horizontalAlignment=t,this.invalidateArrange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"verticalAlignment",{get:function(){return this.inputs.verticalAlignment},set:function(t){this.inputs.verticalAlignment!==t&&(this.inputs.verticalAlignment=t,this.invalidateArrange())},enumerable:!0,configurable:!0}),i.prototype.getAttached=function(t){return this.inputs.attached[t]},i.prototype.setAttached=function(t,e){this.inputs.attached[t]=e},i.prototype.setParent=function(t){if(t){if(t===this.tree.parent)return;this.tree.parent=null,this.onDetached(),this.tree.parent=t,this.onAttached()}else{if(!this.tree.parent)return;this.tree.parent=null,this.onDetached()}},i.prototype.onDetached=function(){this.invalidateMeasure(),this.tree.parent&&this.tree.parent.invalidateMeasure(),t.Rect.undef(this.state.layoutSlot)},i.prototype.onAttached=function(){var r=this.state;t.Size.undef(r.lastAvailable),t.Rect.undef(r.layoutSlot),t.Size.clear(r.arrangedSlot),this.invalidateMeasure(),this.invalidateArrange(),((r.flags&e.LayoutFlags.slotHint)>0||!t.Rect.isUndef(r.lastArrangedSlot))&&this.tree.propagateFlagUp(e.LayoutFlags.slotHint)},i.prototype.walkDeep=function(t){var e=void 0,r=[this];return{current:void 0,step:function(){if(e)for(var i=e.tree.walk(t);i.step();)r.unshift(i.current);return this.current=e=r.shift(),void 0!==this.current},skipBranch:function(){e=void 0}}},i.prototype.invalidateMeasure=function(){this.state.flags|=e.LayoutFlags.measure|e.LayoutFlags.measureHint,this.tree.propagateFlagUp(e.LayoutFlags.measureHint)},i.prototype.doMeasure=function(){var r=this.tree.parent,i=new t.Size;t.Size.copyTo(this.state.lastAvailable,i),!r&&t.Size.isUndef(i)&&(i.width=i.height=Number.POSITIVE_INFINITY);var n=!1;if(!t.Size.isUndef(i)){var a=new t.Size,o=this.state.desiredSize;if(t.Size.copyTo(o,a),n=this.$measurer(i),t.Size.isEqual(a,o))return n}return r&&r.invalidateMeasure(),this.state.flags&=~e.LayoutFlags.measure,n},i.prototype.measure=function(t){return this.$measurer(t)},i.prototype.measureOverride=function(e){for(var r=new t.Size,i=this.tree.walk();i.step();)i.current.measure(e),t.Size.max(r,i.current.state.desiredSize);return r},i.prototype.invalidateArrange=function(){this.state.flags|=e.LayoutFlags.arrange|e.LayoutFlags.arrangeHint,this.tree.propagateFlagUp(e.LayoutFlags.arrangeHint)},i.prototype.doArrange=function(e){var r=this.tree.parent,i=new t.Rect;return r?t.Size.copyTo(this.state.desiredSize,i):t.Size.copyTo(e,i),t.Rect.isUndef(i)?(r&&r.invalidateArrange(),!1):this.$arranger(i)},i.prototype.arrange=function(t){return this.$arranger(t)},i.prototype.arrangeOverride=function(e){for(var r=new t.Size(e.width,e.height),i=this.tree.walk();i.step();){var n=new t.Rect(0,0,e.width,e.height);i.current.arrange(n)}return r},i.prototype.slot=function(e,r){var i=this.state;return t.Rect.isUndef(i.lastArrangedSlot)||t.Rect.copyTo(i.lastArrangedSlot,e),t.Rect.copyTo(i.arrangedSlot,r),t.Rect.undef(i.lastArrangedSlot),!0},i}();e.LayoutNode=i}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){function e(e){var r=i[e];return r?new r:new t.core.LayoutNode}function r(t,e){i[t]&&console.warn("[mirage] Overriding type registration for "+t),i[t]=e}var i={};t.createNodeByType=e,t.registerNodeType=r}(mirage||(mirage={}));var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mirage;!function(t){function e(){var e=t.core.DefaultLayoutTree();return e.children=[],e.walk=function(t){if(t){var r=e.children.length;return{current:void 0,step:function(){return r--,r<0?(this.current=void 0,!1):(this.current=e.children[r],!0)}}}var r=-1;return{current:void 0,step:function(){return r++,r>=e.children.length?(this.current=void 0,!1):(this.current=e.children[r],!0)}}},e}var r=function(r){function i(){r.apply(this,arguments)}return __extends(i,r),i.prototype.createTree=function(){return e()},i.prototype.measureOverride=function(e){return new t.Size(e.width,e.height)},i.prototype.arrangeOverride=function(e){return new t.Size(e.width,e.height)},Object.defineProperty(i.prototype,"childCount",{get:function(){return this.tree.children.length},enumerable:!0,configurable:!0}),i.prototype.insertChild=function(t,e){var r=this.tree.children;e>=r.length?this.appendChild(t):e<=0?this.prependChild(t):(r.splice(e,0,t),t.setParent(this))},i.prototype.prependChild=function(t){this.tree.children.unshift(t),t.setParent(this)},i.prototype.appendChild=function(t){this.tree.children.push(t),t.setParent(this)},i.prototype.removeChild=function(t){var e=this.tree.children,r=e.indexOf(t);return!(r<0)&&(this.tree.children.splice(r,1),t.setParent(null),!0)},i.prototype.removeChildAt=function(t){var e=this.tree.children;if(t<0||t>=e.length)return null;var r=e.splice(t,1)[0];return r&&r.setParent(null),r},i.prototype.getChildAt=function(t){return this.tree.children[t]},i}(t.core.LayoutNode);t.Panel=r,t.registerNodeType("panel",r),t.NewPanelTree=e}(mirage||(mirage={}));var mirage;!function(t){var e=function(){function t(t,e,r,i){this.left=null==t?0:t,this.top=null==e?0:e,this.right=null==r?0:r,this.bottom=null==i?0:i}return t.isEqual=function(t,e){return t.left===e.left&&t.top===e.top&&t.right===e.right&&t.bottom===e.bottom},t.growSize=function(t,e){var r=e.width,i=e.height;return r!=Number.POSITIVE_INFINITY&&(r+=t.left+t.right),i!=Number.POSITIVE_INFINITY&&(i+=t.top+t.bottom),e.width=r>0?r:0,e.height=i>0?i:0,e},t.shrinkSize=function(t,e){var r=e.width,i=e.height;return r!=Number.POSITIVE_INFINITY&&(r-=t.left+t.right),i!=Number.POSITIVE_INFINITY&&(i-=t.top+t.bottom),e.width=r>0?r:0,e.height=i>0?i:0,e},t.shrinkRect=function(t,e){e.x+=t.left,e.y+=t.top,e.width-=t.left+t.right,e.height-=t.top+t.bottom,e.width<0&&(e.width=0),e.height<0&&(e.height=0)},t}();t.Thickness=e}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(t,e){var r=i[t];return r?r(e):e}function r(t,e){i[t]=e}var i={};t.fromString=e,t.registerFromString=r}(e=t.convert||(t.convert={}))}(mirage||(mirage={}));var mirage;!function(t){function e(t){return t?parseFloat(t):0}var r=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.getLeft=function(t){return t.getAttached("canvas.left")},r.setLeft=function(t,e){t.setAttached("canvas.left",e),t.invalidateArrange()},r.getTop=function(t){return t.getAttached("canvas.top")},r.setTop=function(t,e){t.setAttached("canvas.top",e),t.invalidateArrange()},r.prototype.measureOverride=function(e){for(var r=new t.Size(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i=this.tree.walk();i.step();)i.current.measure(r);return new t.Size},r.prototype.arrangeOverride=function(e){for(var i=new t.Rect,n=this.tree.walk();n.step();){var a=n.current;i.x=r.getLeft(a)||0,i.y=r.getTop(a)||0,t.Size.copyTo(a.state.desiredSize,i),a.arrange(i)}return e},r}(t.Panel);t.Canvas=r,t.registerNodeType("canvas",r),t.convert.registerFromString("canvas.top",e),t.convert.registerFromString("canvas.left",e)}(mirage||(mirage={}));var mirage;!function(t){!function(t){t[t.stretch=0]="stretch",t[t.left=1]="left",t[t.center=2]="center",t[t.right=3]="right"}(t.HorizontalAlignment||(t.HorizontalAlignment={}));t.HorizontalAlignment;!function(t){t[t.stretch=0]="stretch",t[t.top=1]="top",t[t.center=2]="center",t[t.bottom=3]="bottom"}(t.VerticalAlignment||(t.VerticalAlignment={}));t.VerticalAlignment;!function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(t.Orientation||(t.Orientation={}));t.Orientation}(mirage||(mirage={}));var mirage;!function(t){function e(t){for(var e=[],i=0,n=t.split(" ");i<n.length;i++){var a=n[i];" "!==a&&e.push(r(a))}return e}function r(){var e,r=0,i=Number.POSITIVE_INFINITY;switch(arguments.length){case 1:e=t.parseGridLength(arguments[0]);break;case 2:e={value:arguments[0],type:arguments[1]};break;case 3:e=t.parseGridLength(arguments[0]),r=arguments[1],i=arguments[2];break;case 4:e={value:arguments[0],type:arguments[1]},r=arguments[2],i=arguments[3];break;default:e={value:1,type:t.GridUnitType.star}}var n=NaN;return{height:e,minHeight:r,maxHeight:i,getActualHeight:function(){return n},setActualHeight:function(t){n=t}}}t.NewRowDefinitions=e,t.NewRowDefinition=r}(mirage||(mirage={}));var mirage;!function(t){function e(t){for(var e=[],i=0,n=t.split(" ");i<n.length;i++){var a=n[i];" "!==a&&e.push(r(a))}return e}function r(){var e,r=0,i=Number.POSITIVE_INFINITY;switch(arguments.length){case 1:e=t.parseGridLength(arguments[0]);break;case 2:e={value:arguments[0],type:arguments[1]};break;case 3:e=t.parseGridLength(arguments[0]),r=arguments[1],i=arguments[2];break;case 4:e={value:arguments[0],type:arguments[1]},r=arguments[2],i=arguments[3];break;default:e={value:1,type:t.GridUnitType.star}}var n=NaN;return{width:e,minWidth:r,maxWidth:i,getActualWidth:function(){return n},setActualWidth:function(t){n=t}}}t.NewColumnDefinitions=e,t.NewColumnDefinition=r}(mirage||(mirage={}));var mirage;!function(t){function e(t){var e=t.tree.parent;e instanceof i&&e.invalidateMeasure(),t.invalidateMeasure()}function r(t){return t?parseInt(t):0}var i=function(r){function i(){r.apply(this,arguments)}return __extends(i,r),i.getColumn=function(t){return t.getAttached("grid.column")},i.setColumn=function(t,r){t.setAttached("grid.column",r),e(t)},i.getColumnSpan=function(t){return t.getAttached("grid.column-span")},i.setColumnSpan=function(t,r){t.setAttached("grid.column-span",r),e(t)},i.getRow=function(t){return t.getAttached("grid.row")},i.setRow=function(t,r){t.setAttached("grid.row",r),e(t)},i.getRowSpan=function(t){return t.getAttached("grid.row-span")},i.setRowSpan=function(t,r){t.setAttached("grid.row-span",r),e(t)},i.prototype.init=function(){r.prototype.init.call(this),this.$measureOverride=t.grid.NewGridMeasureOverride(this.inputs,this.state,this.tree),this.$arrangeOverride=t.grid.NewGridArrangeOverride(this.inputs,this.state,this.tree)},Object.defineProperty(i.prototype,"rowDefinitions",{get:function(){return this.inputs.rowDefinitions},set:function(t){this.inputs.rowDefinitions=t,this.invalidateMeasure()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columnDefinitions",{get:function(){return this.inputs.columnDefinitions},set:function(t){this.inputs.columnDefinitions=t,this.invalidateMeasure()},enumerable:!0,configurable:!0}),i.prototype.createInputs=function(){var t=r.prototype.createInputs.call(this);return t.rowDefinitions=[],t.columnDefinitions=[],t},i.prototype.createState=function(){var e=r.prototype.createState.call(this);return e.design=t.grid.design.NewGridDesign(),e},i.prototype.measureOverride=function(t){return this.$measureOverride(t)},i.prototype.arrangeOverride=function(t){return this.$arrangeOverride(t)},i}(t.Panel);t.Grid=i,t.registerNodeType("grid",i),t.convert.registerFromString("row-definitions",t.NewRowDefinitions),t.convert.registerFromString("column-definitions",t.NewColumnDefinitions),t.convert.registerFromString("grid.row",r),t.convert.registerFromString("grid.row-span",r),t.convert.registerFromString("grid.column",r),t.convert.registerFromString("grid.column-span",r)}(mirage||(mirage={}));var mirage;!function(t){function e(t){var e={value:0,type:r.auto};return"auto"===t?e:"*"===t[t.length-1]?1===t.length?{value:1,type:r.star}:{value:parseInt(t.substr(0,t.length-1)),type:r.star}:{value:parseInt(t),type:r.pixel}}!function(t){t[t.auto=0]="auto",t[t.pixel=1]="pixel",t[t.star=2]="star"}(t.GridUnitType||(t.GridUnitType={}));var r=t.GridUnitType;t.parseGridLength=e}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(t){n.indexOf(t)<0&&n.push(t)}function r(t){var e=n.indexOf(t);e>-1&&n.splice(e,1)}function i(t){for(var e=0;e<n.length;e++)n[e].updateSlots(t)}var n=[];t.register=e,t.unregister=r,t.updateSlots=i}(e=t.adapters||(t.adapters={}))}(mirage||(mirage={}));var mirage;!function(t){var e=function(){function t(t,e){this.x=null==t?0:t,this.y=null==e?0:e}return t.isEqual=function(t,e){return t.x===e.x&&t.y===e.y},t.copyTo=function(t,e){e.x=t.x,e.y=t.y},t.round=function(t){t.x=Math.round(t.x),t.y=Math.round(t.y)},t}();t.Point=e}(mirage||(mirage={}));var mirage;!function(t){var e=function(){function t(t,e,r,i){this.x=null==t?0:t,this.y=null==e?0:e,this.width=null==r?0:r,this.height=null==i?0:i}return t.clear=function(t){t.x=t.y=t.width=t.height=0},t.isEqual=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},t.isEmpty=function(t){return 0===t.width||0===t.height},t.copyTo=function(t,e){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},t.isUndef=function(t){return isNaN(t.x)&&isNaN(t.y)&&isNaN(t.width)&&isNaN(t.height)},t.undef=function(t){t.x=NaN,t.y=NaN,t.width=NaN,t.height=NaN},t}();t.Rect=e}(mirage||(mirage={}));var mirage;!function(t){var e=function(){function t(t,e){this.width=null==t?0:t,this.height=null==e?0:e}return t.copyTo=function(t,e){e.width=t.width,e.height=t.height},t.isEqual=function(t,e){return t.width===e.width&&t.height===e.height},t.isEmpty=function(t){return 0===t.width||0===t.height},t.max=function(t,e){t.width=Math.max(t.width,e.width),t.height=Math.max(t.height,e.height)},t.min=function(t,e){t.width=Math.min(t.width,e.width),t.height=Math.min(t.height,e.height)},t.round=function(t){t.width=Math.round(t.width),t.height=Math.round(t.height)},t.clear=function(t){t.width=0,t.height=0},t.isUndef=function(t){return isNaN(t.width)&&isNaN(t.height)},t.undef=function(t){t.width=NaN,t.height=NaN},t}();t.Size=e}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(t){return"0"!==t&&"false"!==t}function i(t){return t?parseFloat(t)||0:0}function n(t){return t?parseFloat(t):NaN}function a(t){if(!t)return Number.POSITIVE_INFINITY;var e=parseFloat(t);return isNaN(e)?Number.POSITIVE_INFINITY:e}function o(e){var r=u(e);if(1===r.length){var i=parseFloat(r[0]);return new t.Thickness(i,i,i,i)}if(2===r.length){var n=parseFloat(r[0]),a=parseFloat(r[1]);return new t.Thickness(n,a,n,a)}return 4===r.length?new t.Thickness(parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])):void console.warn("[mirage] Invalid thickness value",e)}function s(t){return function(e){return e?t[e]||0:0}}function u(t){for(var e=[],r=0,i=t.split(" ").join(",").split(",");r<i.length;r++){var n=i[r];n&&e.push(n)}return e}e.enumConverter=s,t.convert.registerFromString("visible",r),t.convert.registerFromString("use-layout-rounding",r),t.convert.registerFromString("margin",o),t.convert.registerFromString("width",n),t.convert.registerFromString("height",n),t.convert.registerFromString("min-width",i),t.convert.registerFromString("min-height",i),t.convert.registerFromString("max-width",a),t.convert.registerFromString("max-height",a),t.convert.registerFromString("horizontal-alignment",s(t.HorizontalAlignment)),t.convert.registerFromString("vertical-alignment",s(t.VerticalAlignment))}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),Object.defineProperty(r.prototype,"orientation",{get:function(){return this.inputs.orientation},set:function(t){this.inputs.orientation!==t&&(this.inputs.orientation=t,this.invalidateMeasure(),this.invalidateArrange())},enumerable:!0,configurable:!0}),r.prototype.createInputs=function(){var r=e.prototype.createInputs.call(this);return r.orientation=t.Orientation.horizontal,r},r.prototype.measureOverride=function(e){return this.inputs.orientation===t.Orientation.vertical?this.measureVertical(e):this.measureHorizontal(e)},r.prototype.measureVertical=function(e){var r=new t.Size(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i=new t.Size,n=this.inputs;r.width=e.width,isNaN(n.width)||(r.width=n.width),r.width=Math.min(r.width,n.maxWidth),r.width=Math.max(r.width,n.minWidth);for(var a=this.tree.walk();a.step();){var o=a.current;o.measure(r);var s=o.state.desiredSize;i.height+=s.height,i.width=Math.max(i.width,s.width)}return i},r.prototype.measureHorizontal=function(e){var r=new t.Size(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i=new t.Size,n=this.inputs;r.height=e.height,isNaN(n.height)||(r.height=n.height),r.height=Math.min(r.height,n.maxHeight),r.height=Math.max(r.height,n.minHeight);for(var a=this.tree.walk();a.step();){var o=a.current;o.measure(r);var s=o.state.desiredSize;i.width+=s.width,i.height=Math.max(i.height,s.height)}return i},r.prototype.arrangeOverride=function(e){return this.inputs.orientation===t.Orientation.vertical?this.arrangeVertical(e):this.arrangeHorizontal(e)},r.prototype.arrangeVertical=function(e){for(var r=new t.Size(e.width,0),i=this.tree.walk();i.step();){var n=i.current,a=n.state.desiredSize,o=new t.Rect(0,r.height,e.width,a.height);t.Rect.isEmpty(o)&&t.Rect.clear(o),n.arrange(o),r.width=Math.max(r.width,e.width),r.height+=a.height}return r.height=Math.max(r.height,e.height),r},r.prototype.arrangeHorizontal=function(e){for(var r=new t.Size(0,e.height),i=this.tree.walk();i.step();){var n=i.current,a=n.state.desiredSize,o=new t.Rect(r.width,0,a.width,e.height);t.Rect.isEmpty(o)&&t.Rect.clear(o),n.arrange(o),r.width+=a.width,r.height=Math.max(r.height,e.height)}return r.width=Math.max(r.width,e.width),r},r}(t.Panel);t.StackPanel=e,t.registerNodeType("stack-panel",e),t.convert.registerFromString("orientation",t.core.enumConverter(t.Orientation))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(r,i,n,a){function o(n){var a=new t.Size(n.width,n.height);e.coerceSize(a,r);var o=new t.Size;e.coerceSize(o,r),r.horizontalAlignment===t.HorizontalAlignment.stretch&&(o.width=Math.max(o.width,a.width)),r.verticalAlignment===t.VerticalAlignment.stretch&&(o.height=Math.max(o.height,a.height));var s=new t.Size(i.hiddenDesire.width,i.hiddenDesire.height);return t.Size.max(s,o),s}function s(i,n){var a=new t.Size(n.width,n.height);e.coerceSize(a,r),t.Size.min(a,n);var o=new t.Point;switch(t.Point.copyTo(i,o),r.horizontalAlignment){case t.HorizontalAlignment.left:break;case t.HorizontalAlignment.right:o.x+=i.width-a.width;break;case t.HorizontalAlignment.center:o.x+=.5*(i.width-a.width);break;default:o.x+=Math.max(.5*(i.width-a.width),0)}switch(r.verticalAlignment){case t.VerticalAlignment.top:break;case t.VerticalAlignment.bottom:o.y+=i.height-a.height;break;case t.VerticalAlignment.center:o.y+=.5*(i.height-a.height);break;default:o.y+=Math.max(.5*(i.height-a.height),0)}return r.useLayoutRounding&&t.Point.round(o),o}return function(u){if(r.visible!==!0)return!1;var h=new t.Rect;if(r.useLayoutRounding?(h.x=Math.round(u.x),h.y=Math.round(u.y),h.width=Math.round(u.width),h.height=Math.round(u.height)):t.Rect.copyTo(u,h),h.width<0||h.height<0||!isFinite(h.width)||!isFinite(h.height)||isNaN(h.x)||isNaN(h.y)||isNaN(h.width)||isNaN(h.height))return console.warn("[mirage] cannot call arrange using rect with NaN/infinite values."),!1;if((i.flags&e.LayoutFlags.arrange)<=0)return!1;if(t.Rect.isEqual(i.layoutSlot,h))return!1;t.Rect.copyTo(h,i.layoutSlot),t.Thickness.shrinkRect(r.margin,h);var g=o(h),c=a(g);i.flags&=~e.LayoutFlags.arrange,r.useLayoutRounding&&t.Size.round(c);var l=s(h,c);return t.Point.isEqual(l,i.arrangedSlot)&&t.Size.isEqual(c,i.arrangedSlot)||(t.Rect.copyTo(i.arrangedSlot,i.lastArrangedSlot),i.flags|=e.LayoutFlags.slotHint,n.propagateFlagUp(e.LayoutFlags.slotHint)),t.Size.copyTo(c,i.arrangedSlot),t.Point.copyTo(l,i.arrangedSlot),!0}}e.NewArranger=r}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(){return{parent:null,applyTemplate:function(){return!0},propagateFlagUp:function(t){for(var e=this.parent;e&&(e.state.flags&t)<=0;e=e.tree.parent)e.state.flags|=t},walk:function(t){return{current:void 0,step:function(){return!1}}}}}t.DefaultLayoutTree=e}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){!function(t){t[t.none=0]="none",t[t.measure=2]="measure",t[t.arrange=4]="arrange",t[t.measureHint=8]="measureHint",t[t.arrangeHint=16]="arrangeHint",t[t.slotHint=32]="slotHint",t[t.hints=56]="hints"}(t.LayoutFlags||(t.LayoutFlags={}));t.LayoutFlags}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(r,i,n,a){return function(o){if(isNaN(o.width)||isNaN(o.height))return console.warn("[mirage] cannot call measure using a size with NaN values."),!1;if(r.visible!==!0)return!1;if((i.flags&e.LayoutFlags.measure)<=0)return!1;var s=i.lastAvailable;if(!t.Size.isUndef(s)&&s.width===o.width&&s.height===o.height)return!1;t.Size.copyTo(o,s),n.applyTemplate(),i.flags|=e.LayoutFlags.arrange|e.LayoutFlags.arrangeHint;var u=new t.Size(o.width,o.height);t.Thickness.shrinkSize(r.margin,u),e.coerceSize(u,r);var h=a(u);return i.flags&=~e.LayoutFlags.measure,t.Size.copyTo(h,i.hiddenDesire),e.coerceSize(h,r),t.Thickness.growSize(r.margin,h),h.width=Math.min(h.width,o.width),h.height=Math.min(h.height,o.height),r.useLayoutRounding&&t.Size.round(h),t.Size.copyTo(h,i.desiredSize),!0}}e.NewMeasurer=r}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(t,e){var r=Math.max(e.minWidth,t.width),i=Math.max(e.minHeight,t.height);isNaN(e.width)||(r=e.width),isNaN(e.height)||(i=e.height),r=Math.max(Math.min(r,e.maxWidth),e.minWidth),i=Math.max(Math.min(i,e.maxHeight),e.minHeight),e.useLayoutRounding&&(r=Math.round(r),i=Math.round(i)),t.width=r,t.height=i}t.coerceSize=e}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(t){var e=[];return{flush:function(){for(var t;null!=(t=e.shift());)t.tree.propagateFlagUp(i.arrangeHint)},prepare:function(){for(var r=t.walkDeep();r.step();){var n=r.current;n.inputs.visible&&0!==(n.state.flags&i.arrangeHint)?(n.state.flags&=~i.arrangeHint,(n.state.flags&i.arrange)>0&&e.push(n)):r.skipBranch()}return e.length>0},draft:function(t){for(var r;null!=(r=e.shift());)r.doArrange(t);return!0}}}var i=t.core.LayoutFlags;e.NewArrangeDrafter=r}(e=t.draft||(t.draft={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(t){function r(e,r){if(!t.inputs.visible)return!1;o.flush(),s.flush();var n=t.state.flags;return(n&i.measureHint)>0?a.prepare()&&a.draft():(n&i.arrangeHint)>0?o.prepare()&&o.draft(r):(n&i.slotHint)>0&&(s.prepare()&&s.draft()&&s.notify(e))}var a=e.NewMeasureDrafter(t),o=e.NewArrangeDrafter(t),s=e.NewSlotDrafter(t);return function(e,a){if(0===(t.state.flags&i.hints))return!1;for(var o=!1,s=0;s<n&&r(e,a);s++)o=!0;return s>=n&&console.error("[mirage] aborting infinite draft"),o}}var i=t.core.LayoutFlags,n=255;e.NewDrafter=r}(e=t.draft||(t.draft={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(t){var e=[];return{prepare:function(){for(var r=t.walkDeep();r.step();){var n=r.current;n.inputs.visible&&0!==(n.state.flags&i.measureHint)?(n.state.flags&=~i.measureHint,(n.state.flags&i.measure)>0&&e.push(n)):r.skipBranch()}return e.length>0},draft:function(){for(var t;null!=(t=e.shift());)t.doMeasure();return!0}}}var i=t.core.LayoutFlags;e.NewMeasureDrafter=r}(e=t.draft||(t.draft={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(e){var r=[],n=[];return{flush:function(){for(var t;null!=(t=r.shift());)t.tree.propagateFlagUp(i.slotHint)},prepare:function(){for(var n=e.walkDeep();n.step();){var a=n.current;a.inputs.visible&&0!==(a.state.flags&i.slotHint)?(a.state.flags&=~i.slotHint,t.Rect.isUndef(a.state.lastArrangedSlot)||r.push(a)):n.skipBranch()}return r.length>0},draft:function(){for(var e,i=new t.Rect,a=new t.Rect;null!=(e=r.pop());)e.slot(i,a),t.Rect.isEqual(i,a)||(n.push({node:e,oldRect:i,newRect:a}),i=new t.Rect,a=new t.Rect);return n.length>0},notify:function(t){return t.updateSlots(n),!0}}}var i=t.core.LayoutFlags;e.NewSlotDrafter=r}(e=t.draft||(t.draft={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function r(e,r,i){var n=r.design.arrange;return function(r){n.init(r,e.columnDefinitions,e.rowDefinitions);for(var a=new t.Rect,o=i.walk();o.step();){var s=o.current;n.calcChildRect(a,s),s.arrange(a)}return new t.Size(r.width,r.height)}}e.NewGridArrangeOverride=r}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(e,r,i){var n=r.design.measure,a=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.autoAuto,n,i),o=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.starAuto,n,i),s=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.autoStar,n,i),u=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.starAutoAgain,n,i),h=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.nonStar,n,i),g=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.remainingStar,n,i);return function(t){return n.init(t,e.columnDefinitions,e.rowDefinitions,i),a(),o(),s(),u(),h(),g(),n.finish(),n.getDesired()}}t.NewGridMeasureOverride=e}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var r;!function(e){function r(r,n){return{init:function(a,o,s){i(r),i(n);var u=new t.Size(e.helpers.calcDesiredToOffered(r),e.helpers.calcDesiredToOffered(n));if(u.width!==a.width&&e.helpers.expand(a.width,r),u.height!==a.height&&e.helpers.expand(a.height,n),o)for(var h=0;h<o.length;h++)o[h].setActualWidth(r[h][h].offered);if(s)for(var h=0;h<s.length;h++)s[h].setActualHeight(n[h][h].offered)},calcChildRect:function(e,i){t.Rect.clear(e);var a=t.Grid.getColumn(i)||0;a=Math.min(a,r.length-1);var o=t.Grid.getColumnSpan(i);0!==o&&(o=o||1),o=Math.min(o,r.length-a);var s=t.Grid.getRow(i)||0;s=Math.min(s,n.length-1);var u=t.Grid.getRowSpan(i);0!==u&&(u=u||1),u=Math.min(u,n.length-s);for(var h=0;h<a;h++)e.x+=r[h][h].offered;for(var h=a;h<a+o;h++)e.width+=r[h][h].offered;for(var h=0;h<s;h++)e.y+=n[h][h].offered;for(var h=s;h<s+u;h++)e.height+=n[h][h].offered}}}function i(t){for(var e=0;e<t.length;e++)for(var r=0;r<=e;r++)t[e][r].offered=t[e][r].original}e.NewGridArrangeDesign=r}(r=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){var e;!function(t){function e(t,e){var r=[],i=[];return{init:function(){r.length=0,i.length=0},add:function(n,a,o,s){var u={matrix:n?e:t,start:a,end:a+o-1,size:s};u.start===u.end?r.unshift(u):i.push(u)},allocate:function(t){for(var e;null!=(e=r.pop());){var n=e.start,a=e.end;e.matrix[n][a].desired=Math.max(e.matrix[n][a].desired,e.size),t()}for(;null!=(e=i.pop());){var n=e.start,a=e.end;e.matrix[n][a].desired=Math.max(e.matrix[n][a].desired,e.size),t()}}}}t.NewGridPlacement=e}(e=t.design||(t.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var r;!function(e){function r(t){for(var e=!1,r=!1,i=!1,n=0;n<t.length;n++){var a=t[n];e=e||a.autoRow&&a.autoCol&&!a.starRow&&!a.starCol,r=r||a.starRow&&a.autoCol,i=i||a.autoRow&&a.starCol}return{hasAutoAuto:e,hasStarAuto:r,hasAutoStar:i}}e.NewGridShape=r;var i=function(){function r(){}return r.prototype.init=function(e,r,i){var n=this.col=Math.min(t.Grid.getColumn(e),r.length-1);isNaN(n)&&(this.col=n=0);var a=this.row=Math.min(t.Grid.getRow(e),i.length-1);isNaN(a)&&(this.row=a=0);var o=this.colspan=Math.min(t.Grid.getColumnSpan(e),r.length-n);isNaN(o)&&(this.colspan=o=1);var s=this.rowspan=Math.min(t.Grid.getRowSpan(e),i.length-a);isNaN(s)&&(this.rowspan=s=1),this.starRow=this.autoRow=this.starCol=this.autoCol=!1;for(var u=a;u<a+s;u++)this.starRow=this.starRow||i[u][u].type===t.GridUnitType.star,this.autoRow=this.autoRow||i[u][u].type===t.GridUnitType.auto;for(var u=n;u<n+o;u++)this.starCol=this.starCol||r[u][u].type===t.GridUnitType.star,this.autoCol=this.autoCol||r[u][u].type===t.GridUnitType.auto},r.prototype.shouldMeasurePass=function(t,r,i){return r.width=r.height=0,this.autoRow&&this.autoCol&&!this.starRow&&!this.starCol?i===e.MeasureOverridePass.autoAuto&&(r.width=Number.POSITIVE_INFINITY,r.height=Number.POSITIVE_INFINITY,!0):this.starRow&&this.autoCol&&!this.starCol?(i===e.MeasureOverridePass.starAuto||i===e.MeasureOverridePass.starAutoAgain)&&(i===e.MeasureOverridePass.autoAuto&&t.hasAutoStar&&(r.height=Number.POSITIVE_INFINITY),r.width=Number.POSITIVE_INFINITY,!0):this.autoRow&&this.starCol&&!this.starRow?i===e.MeasureOverridePass.autoStar&&(r.height=Number.POSITIVE_INFINITY,!0):!this.autoRow&&!this.autoCol||this.starRow||this.starCol?this.starRow||this.starCol?i===e.MeasureOverridePass.remainingStar:i===e.MeasureOverridePass.nonStar:i===e.MeasureOverridePass.nonStar&&(this.autoRow&&(r.height=Number.POSITIVE_INFINITY),
this.autoCol&&(r.width=Number.POSITIVE_INFINITY),!0)},r.prototype.calcConstraint=function(t,e,r){for(var i=this.row;i<this.row+this.rowspan;i++)t.height+=r[i][i].offered;for(var i=this.col;i<this.col+this.colspan;i++)t.width+=e[i][i].offered},r}();e.GridChildShape=i}(r=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var r;!function(e){var r;!function(e){function r(e,r){for(var n=0;n<r.length;n++){var a=r[n][n];a.type===t.GridUnitType.star?a.offered=0:e=Math.max(e-a.offered,0)}i(r,0,r.length-1,e,t.GridUnitType.star,!1)}function i(e,r,i,n,a,o){for(var s=0,u=!1,h=0,g=r;g<=i;g++){var c=e[g][g];h=o?c.desired:c.offered,h<c.max&&(s+=a===t.GridUnitType.star?c.stars:1)}do{u=!1;for(var l=n/s,g=r;g<=i;g++){var c=e[g][g];if(h=o?c.desired:c.offered,c.type===a&&h<c.max){var d=h;d+=l*(a===t.GridUnitType.star?c.stars:1),d=Math.min(d,c.max),u=u||d>h,n-=d-h,o?c.desired=d:c.offered=d}}}while(u);return n}function n(t){for(var e=0,r=0;r<t.length;r++)e+=t[r][r].offered=t[r][r].desired;return e}e.expand=r,e.assignSize=i,e.calcDesiredToOffered=n}(r=e.helpers||(e.helpers={}))}(r=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){var e;!function(t){function e(){var e=[],r=[];return{measure:t.NewGridMeasureDesign(e,r),arrange:t.NewGridArrangeDesign(e,r)}}t.NewGridDesign=e}(e=t.design||(t.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var r;!function(e){function r(r,s){var u,h=[],g=e.NewGridPlacement(r,s);return{init:function(t,o,c,l){i(r,o?o.length||1:1),i(s,c?c.length||1:1),n(r,o),a(s,c);for(var d=0,f=l.walk();f.step();d++){var p;d<h.length?h[d]=h[d]||new e.GridChildShape:h.push(p=new e.GridChildShape),p.init(f.current,r,s)}d<h.length&&h.slice(d,h.length-d),u=e.NewGridShape(h),g.init(),l.children.length>0&&(e.helpers.expand(t.width,r),e.helpers.expand(t.height,s))},measureChild:function(i,n,a){var o=h[n],c=new t.Size;if(o&&o.shouldMeasurePass(u,c,i)){o.calcConstraint(c,r,s),a.measure(c);var l=a.state.desiredSize;i!==e.MeasureOverridePass.starAuto&&g.add(!0,o.row,o.rowspan,l.height),g.add(!1,o.col,o.colspan,l.width)}},finishPass:function(){g.allocate(o(r,s))},finish:function(){for(var t=0;t<r.length;t++)for(var e=0;e<=t;e++)r[t][e].original=r[t][e].offered;for(var t=0;t<s.length;t++)for(var e=0;e<=t;e++)s[t][e].original=s[t][e].offered},getDesired:function(){for(var e=new t.Size,i=0;i<r.length;i++)e.width+=r[i][i].desired;for(var i=0;i<s.length;i++)e.height+=s[i][i].desired;return e}}}function i(t,r){t.length>r&&t.splice(r,t.length-r);for(var i=0;i<r;i++){t.length<=i&&t.push([]);var n=t[i];n.length>i+1&&n.splice(i,n.length-i-1);for(var a=0;a<=i;a++)n.length<=a?n.push(new e.Segment):e.Segment.init(n[a])}}function n(r,i){if(!i||0===i.length){var n=r[0][0];return n.type=t.GridUnitType.star,void(n.stars=1)}for(var a=0;a<i.length;a++){var o=i[a],u=o.width||s;o.setActualWidth(Number.POSITIVE_INFINITY);var h=e.Segment.init(r[a][a],0,o.minWidth,o.maxWidth,u.type);u.type===t.GridUnitType.pixel?(h.desired=h.offered=h.clamp(u.value),o.setActualWidth(h.desired)):u.type===t.GridUnitType.star?h.stars=u.value:u.type===t.GridUnitType.auto&&(h.desired=h.offered=h.clamp(0))}}function a(r,i){if(!i||0===i.length){var n=r[0][0];return n.type=t.GridUnitType.star,void(n.stars=1)}for(var a=0;a<i.length;a++){var o=i[a],u=o.height||s;o.setActualHeight(Number.POSITIVE_INFINITY);var h=e.Segment.init(r[a][a],0,o.minHeight,o.maxHeight,u.type);u.type===t.GridUnitType.pixel?(h.desired=h.offered=h.clamp(u.value),o.setActualHeight(h.desired)):u.type===t.GridUnitType.star?h.stars=u.value:u.type===t.GridUnitType.auto&&(h.desired=h.offered=h.clamp(0))}}function o(r,i){function n(e,r,i){for(var n=!1,a=r;a>=i;a--)n=n||e[a][a].type===t.GridUnitType.star;return n}function a(t,e,r){for(var i=0,n=e;n>=r;n--)i+=t[n][n].desired;return i}function o(r){for(var i=r.length,o=i-1;o>=0;o--)for(var s=o;s>=0;s--){var u=n(r,o,s),h=r[o][s].desired,g=a(r,o,s),c=h-g;c>0&&(u?e.helpers.assignSize(r,s,o,c,t.GridUnitType.star,!0):(e.helpers.assignSize(r,s,o,c,t.GridUnitType.pixel,!0),e.helpers.assignSize(r,s,o,c,t.GridUnitType.auto,!0)))}}return function(){o(i),o(r),e.helpers.calcDesiredToOffered(i),e.helpers.calcDesiredToOffered(r)}}e.NewGridMeasureDesign=r;var s={value:1,type:t.GridUnitType.star}}(r=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){var e;!function(t){function e(t,e,r){return function(){for(var i=r.walk(),n=0;i.step();n++)e.measureChild(t,n,i.current);e.finishPass()}}!function(t){t[t.autoAuto=0]="autoAuto",t[t.starAuto=1]="starAuto",t[t.autoStar=2]="autoStar",t[t.starAutoAgain=3]="starAutoAgain",t[t.nonStar=4]="nonStar",t[t.remainingStar=5]="remainingStar"}(t.MeasureOverridePass||(t.MeasureOverridePass={}));t.MeasureOverridePass;t.NewMeasureOverridePass=e}(e=t.design||(t.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var r;!function(e){var r=function(){function e(){this.desired=0,this.offered=0,this.original=0,this.min=0,this.max=Number.POSITIVE_INFINITY,this.stars=0,this.type=t.GridUnitType.pixel}return e.prototype.clamp=function(t){return t<this.min?this.min:t>this.max?this.max:t},e.init=function(e,r,i,n,a){return e.desired=0,e.stars=0,e.offered=r||0,e.min=i||0,e.max=null!=n?n:Number.POSITIVE_INFINITY,e.type=null!=a?a:t.GridUnitType.pixel,e.offered<i?e.offered=i:e.offered>n&&(e.offered=n),e},e}();e.Segment=r}(r=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));
//# sourceMappingURL=mirage.min.js.map
