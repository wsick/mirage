var mirage;!function(t){t.version="0.1.0"}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function i(t){t.invalidateMeasure(),t.invalidateArrange();var e=t.tree.parent;e&&e.invalidateMeasure()}var r=function(){function r(){this.init()}return r.prototype.init=function(){Object.defineProperties(this,{inputs:{value:this.createInputs(),writable:!1},state:{value:this.createState(),writable:!1},tree:{value:this.createTree(),writable:!1},attached:{value:{},writable:!1}}),this.$measurer=this.createMeasurer(),this.$arranger=this.createArranger()},r.prototype.createInputs=function(){return{visible:!0,useLayoutRounding:!0,margin:new t.Thickness,width:NaN,height:NaN,minWidth:0,minHeight:0,maxWidth:Number.POSITIVE_INFINITY,maxHeight:Number.POSITIVE_INFINITY,horizontalAlignment:t.HorizontalAlignment.stretch,verticalAlignment:t.VerticalAlignment.stretch,attached:{}}},r.prototype.createState=function(){return{flags:e.LayoutFlags.none,lastAvailable:new t.Size(NaN,NaN),desiredSize:new t.Size,hiddenDesire:new t.Size,layoutSlot:new t.Rect(NaN,NaN,NaN,NaN),arrangedSlot:new t.Rect,lastArrangedSlot:new t.Rect(NaN,NaN,NaN,NaN)}},r.prototype.createTree=function(){return e.DefaultLayoutTree()},r.prototype.createMeasurer=function(){var t=this;return e.NewMeasurer(this.inputs,this.state,this.tree,function(e){return t.measureOverride(e)})},r.prototype.createArranger=function(){var t=this;return e.NewArranger(this.inputs,this.state,this.tree,function(e){return t.arrangeOverride(e)})},Object.defineProperty(r.prototype,"visible",{get:function(){return this.inputs.visible},set:function(t){if(this.inputs.visible!==t){this.inputs.visible=t===!0,this.invalidateMeasure();var e=this.tree.parent;e&&e.invalidateMeasure()}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"useLayoutRounding",{get:function(){return this.inputs.useLayoutRounding},set:function(t){this.inputs.useLayoutRounding!==t&&(this.inputs.useLayoutRounding=t===!0,this.invalidateMeasure(),this.invalidateArrange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"margin",{get:function(){return this.inputs.margin},set:function(e){t.Thickness.isEqual(this.inputs.margin,e)||(this.inputs.margin=e,i(this))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.inputs.width},set:function(t){this.inputs.width!==t&&(this.inputs.width=t,i(this))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.inputs.height},set:function(t){this.inputs.height!==t&&(this.inputs.height=t,i(this))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"minWidth",{get:function(){return this.inputs.minWidth},set:function(t){this.inputs.minWidth!==t&&(this.inputs.minWidth=t,i(this))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"minHeight",{get:function(){return this.inputs.minHeight},set:function(t){this.inputs.minHeight!==t&&(this.inputs.minHeight=t,i(this))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxWidth",{get:function(){return this.inputs.maxWidth},set:function(t){this.inputs.maxWidth!==t&&(this.inputs.maxWidth=t,i(this))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxHeight",{get:function(){return this.inputs.maxHeight},set:function(t){this.inputs.maxHeight!==t&&(this.inputs.maxHeight=t,i(this))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"horizontalAlignment",{get:function(){return this.inputs.horizontalAlignment},set:function(t){this.inputs.horizontalAlignment!==t&&(this.inputs.horizontalAlignment=t,this.invalidateArrange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"verticalAlignment",{get:function(){return this.inputs.verticalAlignment},set:function(t){this.inputs.verticalAlignment!==t&&(this.inputs.verticalAlignment=t,this.invalidateArrange())},enumerable:!0,configurable:!0}),r.prototype.getAttached=function(t){return this.inputs.attached[t]},r.prototype.setAttached=function(t,e){this.inputs.attached[t]=e},r.prototype.setParent=function(t){if(t){if(t===this.tree.parent)return;this.tree.parent=null,this.onDetached(),this.tree.parent=t,this.onAttached()}else{if(!this.tree.parent)return;this.tree.parent=null,this.onDetached()}},r.prototype.onDetached=function(){this.invalidateMeasure(),this.tree.parent&&this.tree.parent.invalidateMeasure(),t.Rect.undef(this.state.layoutSlot)},r.prototype.onAttached=function(){var i=this.state;t.Size.undef(i.lastAvailable),t.Rect.undef(i.layoutSlot),t.Size.clear(i.arrangedSlot),this.invalidateMeasure(),this.invalidateArrange(),((i.flags&e.LayoutFlags.slotHint)>0||!t.Rect.isUndef(i.lastArrangedSlot))&&this.tree.propagateFlagUp(e.LayoutFlags.slotHint)},r.prototype.walkDeep=function(t){var e=void 0,i=[this];return{current:void 0,step:function(){if(e)for(var r=e.tree.walk(t);r.step();)i.unshift(r.current);return this.current=e=i.shift(),void 0!==this.current},skipBranch:function(){e=void 0}}},r.prototype.invalidateMeasure=function(){this.state.flags|=e.LayoutFlags.measure|e.LayoutFlags.measureHint,this.tree.propagateFlagUp(e.LayoutFlags.measureHint)},r.prototype.doMeasure=function(){var i=this.tree.parent,r=new t.Size;t.Size.copyTo(this.state.lastAvailable,r),!i&&t.Size.isUndef(r)&&(r.width=r.height=Number.POSITIVE_INFINITY);var n=!1;if(!t.Size.isUndef(r)){var a=new t.Size,o=this.state.desiredSize;if(t.Size.copyTo(o,a),n=this.$measurer(r),t.Size.isEqual(a,o))return n}return i&&i.invalidateMeasure(),this.state.flags&=~e.LayoutFlags.measure,n},r.prototype.measure=function(t){return this.$measurer(t)},r.prototype.measureOverride=function(e){for(var i=new t.Size,r=this.tree.walk();r.step();)r.current.measure(e),t.Size.max(i,r.current.state.desiredSize);return i},r.prototype.invalidateArrange=function(){this.state.flags|=e.LayoutFlags.arrange|e.LayoutFlags.arrangeHint,this.tree.propagateFlagUp(e.LayoutFlags.arrangeHint)},r.prototype.doArrange=function(e){var i=this.tree.parent,r=new t.Rect;return i?t.Size.copyTo(this.state.desiredSize,r):t.Size.copyTo(e,r),t.Rect.isUndef(r)?(i&&i.invalidateArrange(),!1):this.$arranger(r)},r.prototype.arrange=function(t){return this.$arranger(t)},r.prototype.arrangeOverride=function(e){for(var i=new t.Size(e.width,e.height),r=this.tree.walk();r.step();){var n=new t.Rect(0,0,e.width,e.height);r.current.arrange(n)}return i},r.prototype.slot=function(e,i){var r=this.state;return t.Rect.isUndef(r.lastArrangedSlot)||t.Rect.copyTo(r.lastArrangedSlot,e),t.Rect.copyTo(r.arrangedSlot,i),t.Rect.undef(r.lastArrangedSlot),!0},r}();e.LayoutNode=r}(e=t.core||(t.core={}))}(mirage||(mirage={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},mirage;!function(t){function e(){var e=t.core.DefaultLayoutTree();return e.children=[],e.walk=function(t){if(t){var i=e.children.length;return{current:void 0,step:function(){return i--,i<0?(this.current=void 0,!1):(this.current=e.children[i],!0)}}}var i=-1;return{current:void 0,step:function(){return i++,i>=e.children.length?(this.current=void 0,!1):(this.current=e.children[i],!0)}}},e}var i=function(i){function r(){i.apply(this,arguments)}return __extends(r,i),r.prototype.createTree=function(){return e()},r.prototype.measureOverride=function(e){return new t.Size(e.width,e.height)},r.prototype.arrangeOverride=function(e){return new t.Size(e.width,e.height)},Object.defineProperty(r.prototype,"childCount",{get:function(){return this.tree.children.length},enumerable:!0,configurable:!0}),r.prototype.insertChild=function(t,e){var i=this.tree.children;e>=i.length?this.appendChild(t):e<=0?this.prependChild(t):(i.splice(e,0,t),t.setParent(this))},r.prototype.prependChild=function(t){this.tree.children.unshift(t),t.setParent(this)},r.prototype.appendChild=function(t){this.tree.children.push(t),t.setParent(this)},r.prototype.removeChild=function(t){var e=this.tree.children,i=e.indexOf(t);return!(i<0)&&(this.tree.children.splice(i,1),t.setParent(null),!0)},r.prototype.removeChildAt=function(t){var e=this.tree.children;if(t<0||t>=e.length)return null;var i=e.splice(t,1)[0];return i&&i.setParent(null),i},r.prototype.getChildAt=function(t){return this.tree.children[t]},r}(t.core.LayoutNode);t.Panel=i,t.NewPanelTree=e}(mirage||(mirage={}));var mirage;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.getLeft=function(t){return t.getAttached("canvas.left")},i.setLeft=function(t,e){t.setAttached("canvas.left",e),t.invalidateArrange()},i.getTop=function(t){return t.getAttached("canvas.top")},i.setTop=function(t,e){t.setAttached("canvas.top",e),t.invalidateArrange()},i.prototype.measureOverride=function(e){for(var i=new t.Size(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),r=this.tree.walk();r.step();)r.current.measure(i);return new t.Size},i.prototype.arrangeOverride=function(e){for(var r=new t.Rect,n=this.tree.walk();n.step();){var a=n.current;r.x=i.getLeft(a)||0,r.y=i.getTop(a)||0,t.Size.copyTo(a.state.desiredSize,r),a.arrange(r)}return e},i}(t.Panel);t.Canvas=e}(mirage||(mirage={}));var mirage;!function(t){!function(t){t[t.left=0]="left",t[t.center=1]="center",t[t.right=2]="right",t[t.stretch=3]="stretch"}(t.HorizontalAlignment||(t.HorizontalAlignment={}));t.HorizontalAlignment;!function(t){t[t.top=0]="top",t[t.center=1]="center",t[t.bottom=2]="bottom",t[t.stretch=3]="stretch"}(t.VerticalAlignment||(t.VerticalAlignment={}));t.VerticalAlignment;!function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(t.Orientation||(t.Orientation={}));t.Orientation}(mirage||(mirage={}));var mirage;!function(t){function e(t){var e=t.tree.parent;e instanceof i&&e.invalidateMeasure(),t.invalidateMeasure()}var i=function(i){function r(){i.apply(this,arguments)}return __extends(r,i),r.getColumn=function(t){return t.getAttached("grid.column")},r.setColumn=function(t,i){t.setAttached("grid.column",i),e(t)},r.getColumnSpan=function(t){return t.getAttached("grid.column-span")},r.setColumnSpan=function(t,i){t.setAttached("grid.column-span",i),e(t)},r.getRow=function(t){return t.getAttached("grid.row")},r.setRow=function(t,i){t.setAttached("grid.row",i),e(t)},r.getRowSpan=function(t){return t.getAttached("grid.row-span")},r.setRowSpan=function(t,i){t.setAttached("grid.row-span",i),e(t)},r.prototype.init=function(){i.prototype.init.call(this),this.$measureOverride=t.grid.NewGridMeasureOverride(this.inputs,this.state,this.tree),this.$arrangeOverride=t.grid.NewGridArrangeOverride(this.inputs,this.state,this.tree)},Object.defineProperty(r.prototype,"rowDefinitions",{get:function(){return this.inputs.rowDefinitions},set:function(t){this.inputs.rowDefinitions=t,this.invalidateMeasure()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnDefinitions",{get:function(){return this.inputs.columnDefinitions},set:function(t){this.inputs.columnDefinitions=t,this.invalidateMeasure()},enumerable:!0,configurable:!0}),r.prototype.createInputs=function(){var t=i.prototype.createInputs.call(this);return t.rowDefinitions=[],t.columnDefinitions=[],t},r.prototype.createState=function(){var e=i.prototype.createState.call(this);return e.design=t.grid.design.NewGridDesign(),e},r.prototype.measureOverride=function(t){return this.$measureOverride(t)},r.prototype.arrangeOverride=function(t){return this.$arrangeOverride(t)},r}(t.Panel);t.Grid=i}(mirage||(mirage={}));var mirage;!function(t){function e(t){for(var e=[],r=0,n=t.split(" ");r<n.length;r++){var a=n[r];" "!==a&&e.push(i(a))}return e}function i(){var e,i=0,r=Number.POSITIVE_INFINITY;switch(arguments.length){case 1:e=t.parseGridLength(arguments[0]);break;case 2:e={value:arguments[0],type:arguments[1]};break;case 3:e=t.parseGridLength(arguments[0]),i=arguments[1],r=arguments[2];break;case 4:e={value:arguments[0],type:arguments[1]},i=arguments[2],r=arguments[3];break;default:e={value:1,type:t.GridUnitType.star}}var n=NaN;return{width:e,minWidth:i,maxWidth:r,getActualWidth:function(){return n},setActualWidth:function(t){n=t}}}t.NewColumnDefinitions=e,t.NewColumnDefinition=i}(mirage||(mirage={}));var mirage;!function(t){function e(t){var e={value:0,type:i.auto};return"auto"===t?e:"*"===t[t.length-1]?1===t.length?{value:1,type:i.star}:{value:parseInt(t.substr(0,t.length-1)),type:i.star}:{value:parseInt(t),type:i.pixel}}!function(t){t[t.auto=0]="auto",t[t.pixel=1]="pixel",t[t.star=2]="star"}(t.GridUnitType||(t.GridUnitType={}));var i=t.GridUnitType;t.parseGridLength=e}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(t){n.indexOf(t)<0&&n.push(t)}function i(t){var e=n.indexOf(t);e>-1&&n.splice(e,1)}function r(t){for(var e=0;e<n.length;e++)n[e].updateSlots(t)}var n=[];t.register=e,t.unregister=i,t.updateSlots=r}(e=t.adapters||(t.adapters={}))}(mirage||(mirage={}));var mirage;!function(t){function e(t){for(var e=[],r=0,n=t.split(" ");r<n.length;r++){var a=n[r];" "!==a&&e.push(i(a))}return e}function i(){var e,i=0,r=Number.POSITIVE_INFINITY;switch(arguments.length){case 1:e=t.parseGridLength(arguments[0]);break;case 2:e={value:arguments[0],type:arguments[1]};break;case 3:e=t.parseGridLength(arguments[0]),i=arguments[1],r=arguments[2];break;case 4:e={value:arguments[0],type:arguments[1]},i=arguments[2],r=arguments[3];break;default:e={value:1,type:t.GridUnitType.star}}var n=NaN;return{height:e,minHeight:i,maxHeight:r,getActualHeight:function(){return n},setActualHeight:function(t){n=t}}}t.NewRowDefinitions=e,t.NewRowDefinition=i}(mirage||(mirage={}));var mirage;!function(t){var e=function(){function t(t,e){this.x=null==t?0:t,this.y=null==e?0:e}return t.isEqual=function(t,e){return t.x===e.x&&t.y===e.y},t.copyTo=function(t,e){e.x=t.x,e.y=t.y},t.round=function(t){t.x=Math.round(t.x),t.y=Math.round(t.y)},t}();t.Point=e}(mirage||(mirage={}));var mirage;!function(t){var e=function(){function t(t,e,i,r){this.x=null==t?0:t,this.y=null==e?0:e,this.width=null==i?0:i,this.height=null==r?0:r}return t.clear=function(t){t.x=t.y=t.width=t.height=0},t.isEqual=function(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height},t.isEmpty=function(t){return 0===t.width||0===t.height},t.copyTo=function(t,e){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},t.isUndef=function(t){return isNaN(t.x)&&isNaN(t.y)&&isNaN(t.width)&&isNaN(t.height)},t.undef=function(t){t.x=NaN,t.y=NaN,t.width=NaN,t.height=NaN},t}();t.Rect=e}(mirage||(mirage={}));var mirage;!function(t){var e=function(){function t(t,e){this.width=null==t?0:t,this.height=null==e?0:e}return t.copyTo=function(t,e){e.width=t.width,e.height=t.height},t.isEqual=function(t,e){return t.width===e.width&&t.height===e.height},t.isEmpty=function(t){return 0===t.width||0===t.height},t.max=function(t,e){t.width=Math.max(t.width,e.width),t.height=Math.max(t.height,e.height)},t.min=function(t,e){t.width=Math.min(t.width,e.width),t.height=Math.min(t.height,e.height)},t.round=function(t){t.width=Math.round(t.width),t.height=Math.round(t.height)},t.clear=function(t){t.width=0,t.height=0},t.isUndef=function(t){return isNaN(t.width)&&isNaN(t.height)},t.undef=function(t){t.width=NaN,t.height=NaN},t}();t.Size=e}(mirage||(mirage={}));var mirage;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),Object.defineProperty(i.prototype,"orientation",{get:function(){return this.inputs.orientation},set:function(t){this.inputs.orientation!==t&&(this.inputs.orientation=t,this.invalidateMeasure(),this.invalidateArrange())},enumerable:!0,configurable:!0}),i.prototype.createInputs=function(){var i=e.prototype.createInputs.call(this);return i.orientation=t.Orientation.horizontal,i},i.prototype.measureOverride=function(e){return this.inputs.orientation===t.Orientation.vertical?this.measureVertical(e):this.measureHorizontal(e)},i.prototype.measureVertical=function(e){var i=new t.Size(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),r=new t.Size,n=this.inputs;i.width=e.width,isNaN(n.width)||(i.width=n.width),i.width=Math.min(i.width,n.maxWidth),i.width=Math.max(i.width,n.minWidth);for(var a=this.tree.walk();a.step();){var o=a.current;o.measure(i);var s=o.state.desiredSize;r.height+=s.height,r.width=Math.max(r.width,s.width)}return r},i.prototype.measureHorizontal=function(e){var i=new t.Size(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),r=new t.Size,n=this.inputs;i.height=e.height,isNaN(n.height)||(i.height=n.height),i.height=Math.min(i.height,n.maxHeight),i.height=Math.max(i.height,n.minHeight);for(var a=this.tree.walk();a.step();){var o=a.current;o.measure(i);var s=o.state.desiredSize;r.width+=s.width,r.height=Math.max(r.height,s.height)}return r},i.prototype.arrangeOverride=function(e){return this.inputs.orientation===t.Orientation.vertical?this.arrangeVertical(e):this.arrangeHorizontal(e)},i.prototype.arrangeVertical=function(e){for(var i=new t.Size(e.width,0),r=this.tree.walk();r.step();){var n=r.current,a=n.state.desiredSize,o=new t.Rect(0,i.height,e.width,a.height);t.Rect.isEmpty(o)&&t.Rect.clear(o),n.arrange(o),i.width=Math.max(i.width,e.width),i.height+=a.height}return i.height=Math.max(i.height,e.height),i},i.prototype.arrangeHorizontal=function(e){for(var i=new t.Size(0,e.height),r=this.tree.walk();r.step();){var n=r.current,a=n.state.desiredSize,o=new t.Rect(i.width,0,a.width,e.height);t.Rect.isEmpty(o)&&t.Rect.clear(o),n.arrange(o),i.width+=a.width,i.height=Math.max(i.height,e.height)}return i.width=Math.max(i.width,e.width),i},i}(t.Panel);t.StackPanel=e}(mirage||(mirage={}));var mirage;!function(t){var e=function(){function t(t,e,i,r){this.left=null==t?0:t,this.top=null==e?0:e,this.right=null==i?0:i,this.bottom=null==r?0:r}return t.isEqual=function(t,e){return t.left===e.left&&t.top===e.top&&t.right===e.right&&t.bottom===e.bottom},t.growSize=function(t,e){var i=e.width,r=e.height;return i!=Number.POSITIVE_INFINITY&&(i+=t.left+t.right),r!=Number.POSITIVE_INFINITY&&(r+=t.top+t.bottom),e.width=i>0?i:0,e.height=r>0?r:0,e},t.shrinkSize=function(t,e){var i=e.width,r=e.height;return i!=Number.POSITIVE_INFINITY&&(i-=t.left+t.right),r!=Number.POSITIVE_INFINITY&&(r-=t.top+t.bottom),e.width=i>0?i:0,e.height=r>0?r:0,e},t.shrinkRect=function(t,e){e.x+=t.left,e.y+=t.top,e.width-=t.left+t.right,e.height-=t.top+t.bottom,e.width<0&&(e.width=0),e.height<0&&(e.height=0)},t}();t.Thickness=e}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function i(i,r,n,a){function o(n){var a=new t.Size(n.width,n.height);e.coerceSize(a,i);var o=new t.Size;e.coerceSize(o,i),i.horizontalAlignment===t.HorizontalAlignment.stretch&&(o.width=Math.max(o.width,a.width)),i.verticalAlignment===t.VerticalAlignment.stretch&&(o.height=Math.max(o.height,a.height));var s=new t.Size(r.hiddenDesire.width,r.hiddenDesire.height);return t.Size.max(s,o),s}function s(r,n){var a=new t.Size(n.width,n.height);e.coerceSize(a,i),t.Size.min(a,n);var o=new t.Point;switch(t.Point.copyTo(r,o),i.horizontalAlignment){case t.HorizontalAlignment.left:break;case t.HorizontalAlignment.right:o.x+=r.width-a.width;break;case t.HorizontalAlignment.center:o.x+=.5*(r.width-a.width);break;default:o.x+=Math.max(.5*(r.width-a.width),0)}switch(i.verticalAlignment){case t.VerticalAlignment.top:break;case t.VerticalAlignment.bottom:o.y+=r.height-a.height;break;case t.VerticalAlignment.center:o.y+=.5*(r.height-a.height);break;default:o.y+=Math.max(.5*(r.height-a.height),0)}return i.useLayoutRounding&&t.Point.round(o),o}return function(u){if(i.visible!==!0)return!1;var h=new t.Rect;if(i.useLayoutRounding?(h.x=Math.round(u.x),h.y=Math.round(u.y),h.width=Math.round(u.width),h.height=Math.round(u.height)):t.Rect.copyTo(u,h),h.width<0||h.height<0||!isFinite(h.width)||!isFinite(h.height)||isNaN(h.x)||isNaN(h.y)||isNaN(h.width)||isNaN(h.height))return console.warn("[mirage] cannot call arrange using rect with NaN/infinite values."),!1;if((r.flags&e.LayoutFlags.arrange)<=0)return!1;if(t.Rect.isEqual(r.layoutSlot,h))return!1;t.Rect.copyTo(h,r.layoutSlot),t.Thickness.shrinkRect(i.margin,h);var g=o(h),c=a(g);r.flags&=~e.LayoutFlags.arrange,i.useLayoutRounding&&t.Size.round(c);var d=s(h,c);return t.Point.isEqual(d,r.arrangedSlot)&&t.Size.isEqual(c,r.arrangedSlot)||(t.Rect.copyTo(r.arrangedSlot,r.lastArrangedSlot),r.flags|=e.LayoutFlags.slotHint,n.propagateFlagUp(e.LayoutFlags.slotHint)),t.Size.copyTo(c,r.arrangedSlot),t.Point.copyTo(d,r.arrangedSlot),!0}}e.NewArranger=i}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(){return{parent:null,applyTemplate:function(){return!0},propagateFlagUp:function(t){for(var e=this.parent;e&&(e.state.flags&t)<=0;e=e.tree.parent)e.state.flags|=t},walk:function(t){return{current:void 0,step:function(){return!1}}}}}t.DefaultLayoutTree=e}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){!function(t){t[t.none=0]="none",t[t.measure=2]="measure",t[t.arrange=4]="arrange",t[t.measureHint=8]="measureHint",t[t.arrangeHint=16]="arrangeHint",t[t.slotHint=32]="slotHint",t[t.hints=56]="hints"}(t.LayoutFlags||(t.LayoutFlags={}));t.LayoutFlags}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function i(i,r,n,a){return function(o){if(isNaN(o.width)||isNaN(o.height))return console.warn("[mirage] cannot call measure using a size with NaN values."),!1;if(i.visible!==!0)return!1;if((r.flags&e.LayoutFlags.measure)<=0)return!1;var s=r.lastAvailable;if(!t.Size.isUndef(s)&&s.width===o.width&&s.height===o.height)return!1;t.Size.copyTo(o,s),n.applyTemplate(),r.flags|=e.LayoutFlags.arrange|e.LayoutFlags.arrangeHint;var u=new t.Size(o.width,o.height);t.Thickness.shrinkSize(i.margin,u),e.coerceSize(u,i);var h=a(u);return r.flags&=~e.LayoutFlags.measure,t.Size.copyTo(h,r.hiddenDesire),e.coerceSize(h,i),t.Thickness.growSize(i.margin,h),h.width=Math.min(h.width,o.width),h.height=Math.min(h.height,o.height),i.useLayoutRounding&&t.Size.round(h),t.Size.copyTo(h,r.desiredSize),!0}}e.NewMeasurer=i}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(t,e){var i=Math.max(e.minWidth,t.width),r=Math.max(e.minHeight,t.height);isNaN(e.width)||(i=e.width),isNaN(e.height)||(r=e.height),i=Math.max(Math.min(i,e.maxWidth),e.minWidth),r=Math.max(Math.min(r,e.maxHeight),e.minHeight),e.useLayoutRounding&&(i=Math.round(i),r=Math.round(r)),t.width=i,t.height=r}t.coerceSize=e}(e=t.core||(t.core={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function i(t,e){var i=[];return{flush:function(){for(var t;null!=(t=i.shift());)t.tree.propagateFlagUp(r.arrangeHint)},prepare:function(){for(var e=t.walkDeep();e.step();){var n=e.current;n.inputs.visible&&0!==(n.state.flags&r.arrangeHint)?(n.state.flags&=~r.arrangeHint,(n.state.flags&r.arrange)>0&&i.push(n)):e.skipBranch()}return i.length>0},draft:function(){for(var t;null!=(t=i.shift());)t.doArrange(e);return!0}}}var r=t.core.LayoutFlags;e.NewArrangeDrafter=i}(e=t.draft||(t.draft={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function i(t,i){function a(){if(!t.inputs.visible)return!1;s.flush(),u.flush();var e=t.state.flags;return(e&r.measureHint)>0?o.prepare()&&o.draft():(e&r.arrangeHint)>0?s.prepare()&&s.draft():(e&r.slotHint)>0&&(u.prepare()&&u.draft()&&u.notify())}var o=e.NewMeasureDrafter(t,i),s=e.NewArrangeDrafter(t,i),u=e.NewSlotDrafter(t);return function(){if(0===(t.state.flags&r.hints))return!1;for(var e=!1,i=0;i<n&&a();i++)e=!0;return i>=n&&console.error("[mirage] aborting infinite draft"),e}}var r=t.core.LayoutFlags,n=255;e.NewDrafter=i}(e=t.draft||(t.draft={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function i(t,e){var i=[];return{prepare:function(){for(var e=t.walkDeep();e.step();){var n=e.current;n.inputs.visible&&0!==(n.state.flags&r.measureHint)?(n.state.flags&=~r.measureHint,(n.state.flags&r.measure)>0&&i.push(n)):e.skipBranch()}return i.length>0},draft:function(){for(var t;null!=(t=i.shift());)t.doMeasure();return!0}}}var r=t.core.LayoutFlags;e.NewMeasureDrafter=i}(e=t.draft||(t.draft={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function i(e){var i=[],n=[];return{flush:function(){for(var t;null!=(t=i.shift());)t.tree.propagateFlagUp(r.slotHint)},prepare:function(){for(var n=e.walkDeep();n.step();){var a=n.current;a.inputs.visible&&0!==(a.state.flags&r.slotHint)?(a.state.flags&=~r.slotHint,t.Rect.isUndef(a.state.lastArrangedSlot)||i.push(a)):n.skipBranch()}return i.length>0},draft:function(){for(var e,r=new t.Rect,a=new t.Rect;null!=(e=i.pop());)e.slot(r,a),t.Rect.isEqual(r,a)||(n.push({node:e,oldRect:r,newRect:a}),r=new t.Rect,a=new t.Rect);return n.length>0},notify:function(){return t.adapters.updateSlots(n),!0}}}var r=t.core.LayoutFlags;e.NewSlotDrafter=i}(e=t.draft||(t.draft={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){function i(e,i,r){var n=i.design.arrange;return function(i){n.init(i,e.columnDefinitions,e.rowDefinitions);for(var a=new t.Rect,o=r.walk();o.step();){var s=o.current;n.calcChildRect(a,s),s.arrange(a)}return new t.Size(i.width,i.height)}}e.NewGridArrangeOverride=i}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){function e(e,i,r){var n=i.design.measure,a=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.autoAuto,n,r),o=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.starAuto,n,r),s=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.autoStar,n,r),u=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.starAutoAgain,n,r),h=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.nonStar,n,r),g=t.design.NewMeasureOverridePass(t.design.MeasureOverridePass.remainingStar,n,r);return function(t){return n.init(t,e.columnDefinitions,e.rowDefinitions,r),a(),o(),s(),u(),h(),g(),n.finish(),n.getDesired()}}t.NewGridMeasureOverride=e}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var i;!function(e){function i(i,n){return{init:function(a,o,s){r(i),r(n);var u=new t.Size(e.helpers.calcDesiredToOffered(i),e.helpers.calcDesiredToOffered(n));if(u.width!==a.width&&e.helpers.expand(a.width,i),u.height!==a.height&&e.helpers.expand(a.height,n),o)for(var h=0;h<o.length;h++)o[h].setActualWidth(i[h][h].offered);if(s)for(var h=0;h<s.length;h++)s[h].setActualHeight(n[h][h].offered)},calcChildRect:function(e,r){t.Rect.clear(e);var a=t.Grid.getColumn(r)||0;a=Math.min(a,i.length-1);var o=t.Grid.getColumnSpan(r);0!==o&&(o=o||1),o=Math.min(o,i.length-a);var s=t.Grid.getRow(r)||0;s=Math.min(s,n.length-1);var u=t.Grid.getRowSpan(r);0!==u&&(u=u||1),u=Math.min(u,n.length-s);for(var h=0;h<a;h++)e.x+=i[h][h].offered;for(var h=a;h<a+o;h++)e.width+=i[h][h].offered;for(var h=0;h<s;h++)e.y+=n[h][h].offered;for(var h=s;h<s+u;h++)e.height+=n[h][h].offered}}}function r(t){for(var e=0;e<t.length;e++)for(var i=0;i<=e;i++)t[e][i].offered=t[e][i].original}e.NewGridArrangeDesign=i}(i=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){var e;!function(t){function e(t,e){var i=[],r=[];return{init:function(){i.length=0,r.length=0},add:function(n,a,o,s){var u={matrix:n?e:t,start:a,end:a+o-1,size:s};u.start===u.end?i.unshift(u):r.push(u)},allocate:function(t){for(var e;null!=(e=i.pop());){var n=e.start,a=e.end;e.matrix[n][a].desired=Math.max(e.matrix[n][a].desired,e.size),t()}for(;null!=(e=r.pop());){var n=e.start,a=e.end;e.matrix[n][a].desired=Math.max(e.matrix[n][a].desired,e.size),t()}}}}t.NewGridPlacement=e}(e=t.design||(t.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var i;!function(e){function i(t){for(var e=!1,i=!1,r=!1,n=0;n<t.length;n++){var a=t[n];e=e||a.autoRow&&a.autoCol&&!a.starRow&&!a.starCol,i=i||a.starRow&&a.autoCol,r=r||a.autoRow&&a.starCol}return{hasAutoAuto:e,hasStarAuto:i,hasAutoStar:r}}e.NewGridShape=i;var r=function(){function i(){}return i.prototype.init=function(e,i,r){var n=this.col=Math.min(t.Grid.getColumn(e),i.length-1);isNaN(n)&&(this.col=n=0);var a=this.row=Math.min(t.Grid.getRow(e),r.length-1);isNaN(a)&&(this.row=a=0);var o=this.colspan=Math.min(t.Grid.getColumnSpan(e),i.length-n);isNaN(o)&&(this.colspan=o=1);var s=this.rowspan=Math.min(t.Grid.getRowSpan(e),r.length-a);isNaN(s)&&(this.rowspan=s=1),this.starRow=this.autoRow=this.starCol=this.autoCol=!1;for(var u=a;u<a+s;u++)this.starRow=this.starRow||r[u][u].type===t.GridUnitType.star,this.autoRow=this.autoRow||r[u][u].type===t.GridUnitType.auto;for(var u=n;u<n+o;u++)this.starCol=this.starCol||i[u][u].type===t.GridUnitType.star,this.autoCol=this.autoCol||i[u][u].type===t.GridUnitType.auto},i.prototype.shouldMeasurePass=function(t,i,r){return i.width=i.height=0,this.autoRow&&this.autoCol&&!this.starRow&&!this.starCol?r===e.MeasureOverridePass.autoAuto&&(i.width=Number.POSITIVE_INFINITY,i.height=Number.POSITIVE_INFINITY,!0):this.starRow&&this.autoCol&&!this.starCol?(r===e.MeasureOverridePass.starAuto||r===e.MeasureOverridePass.starAutoAgain)&&(r===e.MeasureOverridePass.autoAuto&&t.hasAutoStar&&(i.height=Number.POSITIVE_INFINITY),i.width=Number.POSITIVE_INFINITY,!0):this.autoRow&&this.starCol&&!this.starRow?r===e.MeasureOverridePass.autoStar&&(i.height=Number.POSITIVE_INFINITY,!0):!this.autoRow&&!this.autoCol||this.starRow||this.starCol?this.starRow||this.starCol?r===e.MeasureOverridePass.remainingStar:r===e.MeasureOverridePass.nonStar:r===e.MeasureOverridePass.nonStar&&(this.autoRow&&(i.height=Number.POSITIVE_INFINITY),this.autoCol&&(i.width=Number.POSITIVE_INFINITY),!0)},i.prototype.calcConstraint=function(t,e,i){for(var r=this.row;r<this.row+this.rowspan;r++)t.height+=i[r][r].offered;for(var r=this.col;r<this.col+this.colspan;r++)t.width+=e[r][r].offered},i}();e.GridChildShape=r}(i=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var i;!function(e){var i;!function(e){function i(e,i){for(var n=0;n<i.length;n++){var a=i[n][n];a.type===t.GridUnitType.star?a.offered=0:e=Math.max(e-a.offered,0)}r(i,0,i.length-1,e,t.GridUnitType.star,!1)}function r(e,i,r,n,a,o){for(var s=0,u=!1,h=0,g=i;g<=r;g++){var c=e[g][g];h=o?c.desired:c.offered,h<c.max&&(s+=a===t.GridUnitType.star?c.stars:1)}do{u=!1;for(var d=n/s,g=i;g<=r;g++){var c=e[g][g];if(h=o?c.desired:c.offered,c.type===a&&h<c.max){var l=h;l+=d*(a===t.GridUnitType.star?c.stars:1),l=Math.min(l,c.max),u=u||l>h,n-=l-h,o?c.desired=l:c.offered=l}}}while(u);return n}function n(t){for(var e=0,i=0;i<t.length;i++)e+=t[i][i].offered=t[i][i].desired;return e}e.expand=i,e.assignSize=r,e.calcDesiredToOffered=n}(i=e.helpers||(e.helpers={}))}(i=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){var e;!function(t){function e(){var e=[],i=[];return{measure:t.NewGridMeasureDesign(e,i),arrange:t.NewGridArrangeDesign(e,i)}}t.NewGridDesign=e}(e=t.design||(t.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var i;!function(e){function i(i,s){var u,h=[],g=e.NewGridPlacement(i,s);return{init:function(t,o,c,d){r(i,o?o.length||1:1),r(s,c?c.length||1:1),n(i,o),a(s,c);for(var l=0,f=d.walk();f.step();l++){var p;l<h.length?h[l]=h[l]||new e.GridChildShape:h.push(p=new e.GridChildShape),p.init(f.current,i,s)}l<h.length&&h.slice(l,h.length-l),u=e.NewGridShape(h),g.init(),d.children.length>0&&(e.helpers.expand(t.width,i),e.helpers.expand(t.height,s))},measureChild:function(r,n,a){var o=h[n],c=new t.Size;if(o&&o.shouldMeasurePass(u,c,r)){o.calcConstraint(c,i,s),a.measure(c);var d=a.state.desiredSize;r!==e.MeasureOverridePass.starAuto&&g.add(!0,o.row,o.rowspan,d.height),g.add(!1,o.col,o.colspan,d.width)}},finishPass:function(){g.allocate(o(i,s))},finish:function(){for(var t=0;t<i.length;t++)for(var e=0;e<=t;e++)i[t][e].original=i[t][e].offered;for(var t=0;t<s.length;t++)for(var e=0;e<=t;e++)s[t][e].original=s[t][e].offered;
},getDesired:function(){for(var e=new t.Size,r=0;r<i.length;r++)e.width+=i[r][r].desired;for(var r=0;r<s.length;r++)e.height+=s[r][r].desired;return e}}}function r(t,i){t.length>i&&t.splice(i,t.length-i);for(var r=0;r<i;r++){t.length<=r&&t.push([]);var n=t[r];n.length>r+1&&n.splice(r,n.length-r-1);for(var a=0;a<=r;a++)n.length<=a?n.push(new e.Segment):e.Segment.init(n[a])}}function n(i,r){if(!r||0===r.length){var n=i[0][0];return n.type=t.GridUnitType.star,void(n.stars=1)}for(var a=0;a<r.length;a++){var o=r[a],u=o.width||s;o.setActualWidth(Number.POSITIVE_INFINITY);var h=e.Segment.init(i[a][a],0,o.minWidth,o.maxWidth,u.type);u.type===t.GridUnitType.pixel?(h.desired=h.offered=h.clamp(u.value),o.setActualWidth(h.desired)):u.type===t.GridUnitType.star?h.stars=u.value:u.type===t.GridUnitType.auto&&(h.desired=h.offered=h.clamp(0))}}function a(i,r){if(!r||0===r.length){var n=i[0][0];return n.type=t.GridUnitType.star,void(n.stars=1)}for(var a=0;a<r.length;a++){var o=r[a],u=o.height||s;o.setActualHeight(Number.POSITIVE_INFINITY);var h=e.Segment.init(i[a][a],0,o.minHeight,o.maxHeight,u.type);u.type===t.GridUnitType.pixel?(h.desired=h.offered=h.clamp(u.value),o.setActualHeight(h.desired)):u.type===t.GridUnitType.star?h.stars=u.value:u.type===t.GridUnitType.auto&&(h.desired=h.offered=h.clamp(0))}}function o(i,r){function n(e,i,r){for(var n=!1,a=i;a>=r;a--)n=n||e[a][a].type===t.GridUnitType.star;return n}function a(t,e,i){for(var r=0,n=e;n>=i;n--)r+=t[n][n].desired;return r}function o(i){for(var r=i.length,o=r-1;o>=0;o--)for(var s=o;s>=0;s--){var u=n(i,o,s),h=i[o][s].desired,g=a(i,o,s),c=h-g;c>0&&(u?e.helpers.assignSize(i,s,o,c,t.GridUnitType.star,!0):(e.helpers.assignSize(i,s,o,c,t.GridUnitType.pixel,!0),e.helpers.assignSize(i,s,o,c,t.GridUnitType.auto,!0)))}}return function(){o(r),o(i),e.helpers.calcDesiredToOffered(r),e.helpers.calcDesiredToOffered(i)}}e.NewGridMeasureDesign=i;var s={value:1,type:t.GridUnitType.star}}(i=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(t){var e;!function(t){function e(t,e,i){return function(){for(var r=i.walk(),n=0;r.step();n++)e.measureChild(t,n,r.current);e.finishPass()}}!function(t){t[t.autoAuto=0]="autoAuto",t[t.starAuto=1]="starAuto",t[t.autoStar=2]="autoStar",t[t.starAutoAgain=3]="starAutoAgain",t[t.nonStar=4]="nonStar",t[t.remainingStar=5]="remainingStar"}(t.MeasureOverridePass||(t.MeasureOverridePass={}));t.MeasureOverridePass;t.NewMeasureOverridePass=e}(e=t.design||(t.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));var mirage;!function(t){var e;!function(e){var i;!function(e){var i=function(){function e(){this.desired=0,this.offered=0,this.original=0,this.min=0,this.max=Number.POSITIVE_INFINITY,this.stars=0,this.type=t.GridUnitType.pixel}return e.prototype.clamp=function(t){return t<this.min?this.min:t>this.max?this.max:t},e.init=function(e,i,r,n,a){return e.desired=0,e.stars=0,e.offered=i||0,e.min=r||0,e.max=null!=n?n:Number.POSITIVE_INFINITY,e.type=null!=a?a:t.GridUnitType.pixel,e.offered<r?e.offered=r:e.offered>n&&(e.offered=n),e},e}();e.Segment=i}(i=e.design||(e.design={}))}(e=t.grid||(t.grid={}))}(mirage||(mirage={}));
//# sourceMappingURL=mirage.min.js.map
